\section{Modelling HIV Transmission}\label{intro.model}
Mathematical models of infectious disease transmission
date back at least 100 years \cite{Hethcote2000}.
Transmission models are distinguished from statistical models by
mechanistic and iterative representations of transmission, such that
nonlinear dynamics can be simulated \cite{Garnett2011}.
Transmission models can be further classified by several factors,
including whether simulations are stochastic (random) \vs deterministic,
and whether the basic model units are
individuals (individual-based models) \vs
groups of individuals (compartmental-based models);
further differences among models are discussed in
\sref{foi.prior.alt} and \cite{Garnett2011,Johnson2016mf}.
%===================================================================================================
\subsection{Deterministic Compartmental Models}\label{intro.model.dcm}
Deterministic Compartmental Models (DCMs) are
a popular type of transmission model which make two defining assumptions:
1) modelled populations can be stratified into distinct states (compartments), where
   individuals in each state are indistinguishable from one another
   --- \ie compartments are homogeneous; and
2) stochastic effects are negligible,
   which can be justifiable for large populations \cite{Isham1988}.
Despite the limitations associated with these assumptions \cite{Liljeros2003,Johnson2016mf},
DCMs remain popular due to their simplicity
--- in design, implementation, parameterization, calibration, and analysis ---
and smaller data needs \vs stochastic individual-based models \cite{Garnett2011,Johnson2016mf}.
\par % agraph{Model Specification}
DCMs are specified as a set of first order ordinary differential equations of the form:
\begin{equation}
  \frac{d}{dt}\,y_i = f_i(y,\theta,t)
\end{equation} where:
$y_i(y)$ is the number of individuals in state $i$ at time $t$;
$\theta$ is a set of model parameters; and
$f_i$ defines the rate of change in $y_i$ as a function of all other $y$, $\theta$, and $t$,
reflecting mechanistic assumptions about infection transmission and other state transitions.
For example, if the average rate of transition from state $k$ to $k+1$ is $\eta_k$,
then $f_k$ would include a term $-\,\eta_k y_k$ and $f_{k+1}$ would include $+\,\eta_k y_k$.%
\footnote{A constant transition rate also implies an exponentially-distributed duration
  in the originating state; see \sref{app.math.dur.exp} for further details.}
Usually, the most complex rate to specify is
the ``force of infection'', or incidence rate per susceptible.
This rate is specified to reflect assumed pathways of transmission and mediators thereof, such as:
numbers, types, and patterns of sexual partnerships;
frequency and types of sex act per partnership;
biological susceptibility and infectiousness per sex act; as well as
coverage and efficacy of any interventions.
These modelled pathways and mediating factors are inevitably simplified to remain tractable.
Indeed, early DCMs were simple enough to solve analytically,
which helped establish fundamental principles \cite{Hethcote2000}.
However, most modern DCMs must be solved computationally,
for which many techniques and software packages exist (\eg see footnote \ref{foot:ode}).
%===================================================================================================
\subsection{Applications of Transmission Modelling to Support HIV Response}\label{intro.model.apps}
Modelling of HIV transmission began shortly after discovery of the virus \cite{Anderson1986}.
Early models focused on generating mechanistic insights into
key determinants of epidemic dynamics \cite{Isham1988,Garnett1996}.
However, by now such models have been used in
numerous applications to support epidemic response, including:
\begin{itemize}
  \item generating mechanistic insights about epidemic dynamics
        \cite{Garnett1993,Eaton2014ahi,Knight2020}
  \item projecting HIV incidence, prevalence, mortality, etc.
        \cite{Bao2012,Eaton2015}
  \item quantifying the contribution of particular contexts of transmission
        \cite{Mukandavire2018,Silhol2021}
  \item inferring parameter values through model fitting
        \cite{Bellan2015,Johnson2016mf}
  \item projecting the impact of interventions, and combinations thereof
        \cite{Eaton2012,Mishra2014art,Maheu-Giroux2017}
  \item uncertainty and sensitivity analysis of model outputs
        \cite{Hontelez2013,Johnson2016cc,Bernard2017}
        or clinical trial results
        \cite{Cori2014}
  \item and economic analyses
        \cite{Anderson2014,Kerr2015,Phillips2022}
\end{itemize}
The movement towards more applied \vs theoretical modelling
has encouraged development of more complex models,
which include additional population stratifications and historical interventions.
Yet, increases in model complexity are often at odds with
the limited quantity and quality of available data to support them.
Thus, many modellers are involved in data synthesis efforts to generate plausible model inputs
\cite{Boily2009,Bellan2015,Owen2020,Giguere2021}.
As model complexity and applications to specific policy questions have grown,
so too has healthy scrutiny of modelling assumptions \cite{Mishra2014mot,Eaton2015,Geffen2018}.
Such scrutiny must be embraced by modellers in order to
remain transparent, humble, and ultimately accurate,
especially when models are used to guide allocation of massive resources for millions of people.
%===================================================================================================
\subsection{Risk Heterogeneity}\label{intro.model.het}
The central role of individuals with more sexual partners in STI/HIV transmission
has long been recognized in so-called ``core group theory'' \cite{Yorke1978,Stigum1994,Watts2010}.
This theory has since been generalized to consider ``risk heterogeneity'' more broadly,
reflecting differences in acquisition and/or onward transmission risk within a given population.
Such heterogeneity can be driven by
biological factors such as co-infection,
individual-level factors such as numbers of sexual partners, and
network-level fractors such as patterns of sexual mixing,
as well as upstream structural factors which influence all of the above. % TODO: cite?
Indeed, risk heterogeneity is an important factor in all infectious diseases \cite{Suen2017},
and can even be considered to comprise phenomena like superspreading events \cite{Lloyd-Smith2005}.
In the context of HIV, risk heterogeneity is directly related to key populations,
who experience multiple intersecting drivers of risk, as described in \sref{intro.hiv.kp}.
\par
Risk heterogeneity has several key implications for transmission dynamics:
\begin{itemize}
  \item Epidemic potential and challenge of control
    is greater with \vs without risk heterogeneity, given otherwise equivalent conditions;
    for example, under random mixing,
    the basic reproduction number $R_0$ is proportional to $\mu + \sigma^2/\mu$,
    where $\mu$ and $\sigma^2$ are the mean and variance of contact rates \cite{Anderson1986};
    under like-with-like mixing by risk, $R_0$ increases further \cite{Jacquez1988}.
  \item Endemic ``equilibrium'' prevalence
    is lower with \vs without risk heterogeneity \cite{Anderson1986};%
    \footnote{Many modelling analyses have explored infectious disease ``equilibrium'';
      such analyses may offer theoretical insights,
      but are likely of limited value for applied modelling,
      due to numerous dynamic conditions and interventions which preclude epidemic stabilization.}
    this is because rapid early transmission among higher risk groups results in
    ``saturation'' of infection and/or immunity within these groups,
    where fewer and fewer contacts can result in transmission; by contrast,
    transmission among lower risk groups is reduced \vs the homogeneous case,
    because such groups have (by definition) lower than average risk \cite{Anderson1986}.
  \item Turnover of individuals in/out of risk states/groups, sometimes called ``episodic risk'',
    mediates the influence of risk heterogeneity on epidemic dynamics \cite{Stigum1994}; where
    slow turnover can contribute to ``sustaining populations''
    with high infection prevalence \cite{Watts2010}, while
    fast turnover can erode ``saturation'' effects through net replacement of
    infected individuals with susceptible individuals in higher risk groups \cite{Knight2020}.
  \item The relative impact of prioritizing prevention resources to higher risk groups
    will be greater than without prioritization \cite{Mishra2014mot};
    unfortunately, power asymmetries and stigma often undermine efforts to
    prioritize resources to marginalized higher risk groups \cite{Brown2019,Long2021,Mishra2021}.
\end{itemize}
% TODO: (?) asymmetry: contacts vs susceptibility vs infectiousness
%---------------------------------------------------------------------------------------------------
\subsubsection{Where to Draw the Line}
The importance of risk heterogeneity is evidently well-recognized.
However, there are many potential factors that contribute to risk heterogeneity,
and even more ways of representing each factor within a model.
Recognizing time and data constraints to model building, it's rarely obvious
\emph{which factors} should be included in a model,
\emph{how} they should be included, and
\emph{what happens} if they are not adequately modelled.
For example: Should the modelled population be stratified by age, or risk, or both?
How many age and/or risk groups should be modelled?
In other words: \shortquote{Where to draw the line?} \cite{Suen2017}.
The answers to such questions likely depend on both the modelled context and application.
This uncertainty in appropriate model specification
is sometimes called ``structural uncertainty'' \cite{Bernard2017,Suen2017}.
Note that, unlike model specification problems in classic statistics,
the ratio of structural uncertainty \vs available data in transmission modelling
is generally too high to use information criteria-based approaches (\eg~\cite{Zhang2023}).
% TODO: (?) forced to make mechanistic assumptions --> falsifiability
\par
Only a few studies have sought to thoroughly explore how
different representations of major factors could influence HIV model outputs
--- and even then, these studies have focused on the model-estimated impact of
specific interventions in specific epidemic contexts \cite{Hontelez2013,Bernard2017}.%
\footnote{Notably, \cite{Hontelez2013} and several other works \cite{Eaton2012}
  were effectively a direct response to an (in)famous study \cite{Granich2009}
  that made bold conclusions based on a very simple model
  with little justification for model design or parameterization.}
Such strucural comparison studies are impressive feats considering the challenges of
implementing, parameterizing, and calibrating a single model structure, let alone several.
These studies generally found that
increasing model complexity reduced the projected impact of prevention interventions
--- reflecting the influence of risk heterogeneity on the challenge of epidemic control ---
and that no clear threshold of ``sufficient'' complexity emerged,
beyond which model outputs stopped changing with further complexity.
The generalizability of these findings to other contexts and interventions also remains unclear.
